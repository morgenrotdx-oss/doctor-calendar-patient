/* ====== ベース・レイアウト ====== */
body {
  font-family: "Meiryo", sans-serif;
  padding: 16px;
  margin: 0;
  background: #f0f0f5;
  font-size: 16px;
}
h2 {
  text-align: center;
  margin-bottom: 1rem;
}
#tableTitle {
  margin: 0;
  flex-shrink: 0;
  font-size: 1.35rem;
  font-weight: bold;
}

/* 読み込み中オーバーレイ */
.loader {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  background: rgba(255, 255, 255, 0.8);
  font-size: 1.2rem;
  color: #555;
  z-index: 10000;
  font-weight: bold;
}
.loader.show { display: flex; }

/* ====== カレンダー外枠・ナビ ====== */
.calendar-container {
  overflow-x: auto;
}
.calendar-nav {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  margin-bottom: 1rem;
}
.month-nav-btn {
  font-size: 1.5rem;
  padding: 0 1rem;
  border: none;
  background: #f4f4f4;
  border-radius: 4px;
  cursor: pointer;
  transition: background 0.2s;
}
.month-nav-btn:disabled {
  background: #e0e0e0;
  color: #aaa;
  cursor: not-allowed;
}

/* ====== カレンダー本体テーブル ====== */
table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
}
th, td {
  border: 1px solid #ccc;
  padding: 6px;
  text-align: center;
  vertical-align: middle;
  min-width: 45px;
  white-space: normal;
  overflow-wrap: anywhere;
  font-size: 14px;
}
th { background-color: #e6e6e6; }

@media (max-width: 600px) {
  th, td {
    font-size: 11px;
    min-width: 28px;
    padding: 4px 2px;
  }
  h2 { font-size: 1rem; }
}

/* ====== 曜日ヘッダ ====== */
.sunday { color: red; }
.saturday { color: blue; }

/* ====== 週・診療科・日付セル ====== */
.week-row td:first-child {
  background-color: #e1f5fe;
  font-weight: bold;
}
#calendar td:first-child {
  background-color: #fceabb;
  font-weight: bold;
}
#calendar tr.date-row td:first-child {
  background: #fff !important;
}
tr.week-row {
  border-top: 3px solid #aaa !important;
}

/* ====== 特別な日付セル ====== */
#calendar tr:not(.date-row) td.today-cell {
  background: #fff !important;
  border: 2.5px solid #ffb300 !important;
  z-index: 1;
}
#calendar tr.date-row td:not(:first-child):not(.holiday):not(.today-cell) {
  background: #e6f7ff !important;
  font-weight: bold;
  font-size: 1.2em;
}
#calendar tr.date-row td.today-cell {
  background: #ffb300 !important;
  color: #fff !important;
  font-weight: bold;
  border: 3px solid #ff9800 !important;
  font-size: 1.35em;
  z-index: 9;
}

/* データ行の背景 */
#calendar tr:not(.date-row) td:not(:first-child):not(.kyushin-cell):not(.cyousei-cell):not(.yaegashi-cell) {
  background: #fff !important;
}

/* 休診セル */
#calendar tr:not(.date-row) td.kyushin-cell {
  background: #e0e0e0 !important;
  color: #888 !important;
  cursor: default !important;
  pointer-events: none;
}

/* 個別：八重樫 9:30～ */
#calendar tr:not(.date-row) td.yaegashi-cell {
  background: #fff9c4 !important;
  color: #000 !important;
  font-weight: bold !important;
}

/* 祝日 */
#calendar td.holiday {
  background: #e53935 !important;
  color: #fff !important;
  font-weight: bold;
}
tr.week-row td.holiday {
  color: #d32f2f !important;
  font-weight: bold;
}

/* 日付行の土日 */
#calendar tr.date-row td.saturday { color: #1976d2 !important; }
#calendar tr.date-row td.sunday { color: #e53935 !important; }

/* 今日セルが土日の場合 */
#calendar tr.date-row td.today-cell.saturday,
#calendar tr.date-row td.today-cell.sunday {
  background: #ffe066 !important;
  border: 3px solid #ff9800 !important;
}
#calendar tr.date-row td.today-cell.saturday { color: #1976d2 !important; }
#calendar tr.date-row td.today-cell.sunday { color: #e53935 !important; }

/* その他 */
.female { color: red; }
.calendar-note {
  margin: 18px 0 0 0;
  font-size: 0.97em;
  color: #555;
  background: #fffbe8;
  border-left: 4px solid #ffe082;
  padding: 10px 12px;
  border-radius: 5px;
  max-width: 75vw;
  line-height: 1.6;
}

/* ====== モーダル（患者向け：スリム版） ====== */
.cell-modal {
  /* 固定配置・全画面 */
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  width: 100% !important;
  height: 100% !important;
  height: 100dvh !important; /* スマホのアドレスバー対策 */
  
  background: rgba(0,0,0,0.45);
  z-index: 11000;
  
  /* Flexboxでど真ん中へ */
  display: none; /* JSでflexに切り替わる */
  align-items: center !important;
  justify-content: center !important;
  
  /* 余計な余白やズレをリセット */
  padding: 20px !important;
  margin: 0 !important;
  transform: none !important;
}

.cell-modal-content {
  position: relative !important;
  background: #FFE4EC !important; /* ピンク */
  color: #333;
  border: 1px solid #F5C5D5;
  border-radius: 12px;
  box-shadow: 0 16px 40px rgba(0,0,0,0.3);
  text-align: center;
  
  /* ★修正：幅を狭く（スリム化） */
  width: min(340px, 85vw) !important;
  max-height: 80vh;
  overflow-y: auto;
  
  /* 余白調整 */
  padding: 20px 16px !important;
  line-height: 1.5;
  
  /* ズレ防止 */
  margin: 0 !important;
  top: auto !important;
  left: auto !important;
  transform: none !important;
}

/* 文字サイズを全体的に縮小 */
#cellModalTitle { 
  font-size: 22px !important; /* 元30px */
  margin: 0 0 10px; 
  font-weight: 700; 
}
.modal-label { 
  display: block; 
  margin: 8px 0 2px; 
  color: #777; 
  font-size: 14px !important; /* 元20px */
}
.modal-value { 
  margin: 2px 0 8px; 
  font-size: 20px !important; /* 元34px */
  font-weight: 800; 
}

#cellModalClose {
  position: absolute; top: 10px; right: 10px;
  border: 1px solid #d1d5db; background: #fff; color: #111;
  padding: 4px 10px; 
  border-radius: 9999px; 
  font-size: 13px; 
  cursor: pointer;
}

.cell-modal .highlight-time { color: #e53935 !important; font-weight: bold; }
body.no-scroll { overflow: hidden; }

@media (max-width: 600px) {
  .cell-modal-content {
    /* スマホでも幅を少し抑える */
    width: 85vw !important;
    padding: 20px 14px !important;
  }
  /* スマホでの文字サイズ微調整 */
  #cellModalTitle { font-size: 20px !important; }
  .modal-label { font-size: 13px !important; }
  .modal-value { font-size: 18px !important; }
}
